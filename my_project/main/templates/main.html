<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Main</title>
    <style>
      body {
        font-family: 'Times New Roman', serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        background-color: #f5f5f5; /* Light gray background */
      }
      
      .container {
        display: flex;
        flex-wrap: wrap; /* Allow items to wrap to the next line */
        justify-content: space-between;
        align-items: center;
        width: 80%;
        margin: auto; /* Center the container */
      }
      
      #preview-container,
      #dropdown-container,
      #text-area-container {
        box-sizing: border-box;
        width: 100%; /* Full width on small screens */
        margin-top: 10px;
        padding: 15px;
        background-color: #fff; /* White background */
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); /* Subtle box shadow */
        margin-bottom: 15px;
      }
      
      #preview-container {
        border: 1px solid #ccc;
        text-align: center;
      }
      
      #dropdown,
      #text-area,
      #selected-option {
        width: 100%;
        padding: 8px;
        margin-top: 8px;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
      }
      
      #dropdown-container button,
      #text-area-container button {
        padding: 10px;
        margin-top: 10px;
        cursor: pointer;
        background-color: #4caf50; /* Green */
        color: #fff; /* White text */
        border: none;
        border-radius: 4px;
        transition: background-color 0.3s;
      }
      
      #dropdown-container button:hover,
      #text-area-container button:hover {
        background-color: #45a049; /* Darker green on hover */
      }
      
      @media only screen and (min-width: 768px) {
        /* Adjust layout for medium and larger screens */
        #preview-container,
        #dropdown-container,
        #text-area-container {
          width: 30%; /* Reset width for larger screens */
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div id="preview-container">
        <div id="preview">Nothing</div>
      </div>

      <div id="dropdown-container">
        <form action="" method="post">
          {% csrf_token %}
          <label for="makename">What's your name</label>
          <input type="text" id="makename" name="makename" />
          <button type="submit">Submit</button>
          <!-- Add a hidden input field to store the selected dropdown option -->
          <input type="hidden" id="selected-option-hidden" name="selected_option" value="" />

          <!-- Modify the dropdown onchange event to update the hidden input -->
          <select id="dropdown" name="dropdown" onchange="updatePreview()">
            <option value="none"></option>
            {% for i in res %}
              <option value="{{ i }}">{{ i }}</option>
            {% endfor %}
          </select>

          {% if user.is_authenticated %}
            <button type="button" onclick="buyNow()">Buy Now</button>
            <button id="addToCartBtn" type="submit">Add to Cart</button>
          {% else %}
            <p>
              <a href="{% url 'user_login' %}">Login</a> to buy this item.
            </p>
          {% endif %}
        </form>
      </div>

      <div id="text-area-container">
        <label for="text-area">Write anything:</label>
        <textarea id="text-area" rows="4" cols="50" oninput="updatePreview()"></textarea>

        <label for="selected-option">Selected Option:</label>
        <input type="text" id="selected-option" oninput="updatePreview()" />
      </div>
    </div>
    <script>
      function updatePreview() {
        var dropdown = document.getElementById('dropdown')
        var textArea = document.getElementById('text-area')
        var previewDiv = document.getElementById('preview')
        var selectedOptionHidden = document.getElementById('selected-option-hidden')
      
        var selectedOption = dropdown.options[dropdown.selectedIndex].text
        var textAreaContent = textArea.value.trim()
      
        selectedOption = textAreaContent === '' ? selectedOption : ''
      
        var previewContent = `${selectedOption}\n${textAreaContent}`
        previewDiv.textContent = previewContent
        selectedOptionHidden.value = selectedOption
      }
      
      function addToCart() {
        // Add your logic to handle adding to the cart
        // For example, you can send an AJAX request to a server endpoint
        // or update a client-side cart object.
        // For demonstration purposes, let's alert a message.
        alert('Item added to cart!')
      }
      
      document.getElementById('text-area').addEventListener('input', updatePreview)
      document.getElementById('selected-option-hidden').addEventListener('input', updatePreview)
      
      document.getElementById('dropdown').addEventListener('change', function () {
        document.getElementById('text-area').value = ''
        updatePreview()
      })
      
      document.getElementById('addToCartBtn').addEventListener('click', addToCart)
    </script>
  </body>
</html>
